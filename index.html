<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <title>Aira by frbl</title>

  <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
  <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script src="http://code.highcharts.com/highcharts.js"></script>
  <script src="http://code.highcharts.com/modules/exporting.js"></script>
  <link rel="stylesheet" media="all" href="stylesheets/application.css" data-turbolinks-track="true" />
  <link rel="stylesheet" media="all" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" />
  <style>
    #netDynamisch {
      padding-bottom: 50px;
      -webkit-transform: scale(0.767354368932039, 0.767354368932039);
      transform: scale(0.767354368932039, 0.767354368932039);
      height: 245.553398058252px;
    }
    
    footer {
      position: relative;
      bottom: 0;
      width: 100%;
    }
    
    #simulation-buttons {
      margin-right: auto;
      margin-left: auto;
      width: 100%;
    }
    
    #shock {
      font-size: 150%;
      display: none;
      background-color: #ff0000;
    }
    
    .line {
      visibility: hidden;
    }
    
    .visible-line-hover,
    .visible-line-click {
      visibility: visible;
    }
    
    .effect_list {
      min-height: 60px;
    }
  </style>
  <link rel="stylesheet" href="stylesheets/styles.css">
  <link rel="stylesheet" href="stylesheets/pygment_trac.css">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>
  <div class="wrapper">
    <header>
      <h1>Aira</h1>
      <p>Repository of the AIRA project</p>

      <p class="view"><a href="https://github.com/frbl/aira">View the Project on GitHub <small>frbl/aira</small></a></p>


      <ul>
        <li><a href="https://github.com/frbl/aira/zipball/master">Download <strong>ZIP File</strong></a></li>
        <li><a href="https://github.com/frbl/aira/tarball/master">Download <strong>TAR Ball</strong></a></li>
        <li><a href="https://github.com/frbl/aira">View On <strong>GitHub</strong></a></li>
      </ul>
    </header>
    <section>
      <h3> Automated Impulse Response Analysis</h3>
      <p>This is the reposirory of AIRA, or the <i>Automated Impulse Resonse Analysis</i> algorithm. Download the source and include the JavaScript file in your web-page to get started.</p>

      <h3>Example</h3>

      <div class="bubble_chart" id="bubble_chart"></div>
      <div class="effect_list" id="effect_list"><span class=''></span></div>
      <div id="panel" class="col-md-6">
        <form action="">
          <div style="visibility:hidden; width:0px; height:0px;">

            <label> Prediction </label>
            <select id='prediction' class="target">
            </select>
          </div>

          <h4> Data </h4>
          <select id='data_select' class="data_select target">
          </select>
        </form>
      </div>

    </section>
    <footer>
      <p>This project is maintained by <a href="https://github.com/frbl">frbl</a></p>
      <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
    </footer>
  </div>
  <script src="javascripts/scale.fix.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js'></script>
  <script src="javascripts/aira.min.js"></script>

  <script>
    var lags, number_of_variables, aira, simulation, visualization_engine, impulse_response_calculator, view_model;
    var data;
    var variable_mapping;

    var start_simulation = function(json_data) {
      var json_parser = new JsonParser(json_data, variable_mapping);
      var node_names = json_parser.nodeKeysFromJson();

      var data_summary = json_parser.dataSummaryFromJson(node_names);
      var var_coefficients = json_parser.fullNetworkDataToMatrix(node_names);
      var_model = new VarModel(var_coefficients, node_names, data_summary, true, variable_mapping);

      simulation = new Simulation(node_names);
      impulse_response_calculator = new ImpulseResponseCalculator(var_model);
      aira = new Aira(impulse_response_calculator, var_model, view_model);
      visualization_engine = new Visualization(node_names);
    };

    var main = function(json_data) {
      data = json_data;
      view_model = new ViewModel();
      variable_mapping = new VariableMapping();

      var data_keys = getHgiNetworkJsonKeys(json_data);
      var max_steps = 100;
      var max_interpolation = 500;
      var max_threshold = 1;

      var prediction_select = $('#prediction');

      appendSelectOptions(data_keys, '#data_select');
      generateSelectOptions(1, max_steps, 1, '#prediction');

      prediction_select.find("option[value='" + (10 > max_steps ? max_steps : 5) + "']").attr('selected', 'selected');

      $('body').on("change", ".data_select", function() {
        if (simulation != null) simulation.clear();
        $('#netDynamisch').html('');
        testdataset = data[$('#data_select').val()];
        start_simulation(data[$('#data_select').val()]);

        var netEffectOptimizer = new NetEffectOptimizer({
          wanted_increase: view_model.get_improvement()
        });
        var bubbleChartVisualization = new BubbleChartVisualization(aira, netEffectOptimizer);
        bubbleChartVisualization.render();
      });
    };

    $(document).ready(function() {
      $.ajax({
        url: "one_network.json",
        type: "GET",
        dataType: 'json',
        error: function(xhr, ajaxOptions, thrownError) {
          console.log(xhr.status);
          console.log(thrownError);
          console.log('Error!');
        },
        success: function(data, text) {
          console.log('Successfully loaded network data');
          main(data);
        }
      });
    });
  </script>
</body>

</html>
<!--Mon Aug 31 09:52:48 CEST 2015-->
